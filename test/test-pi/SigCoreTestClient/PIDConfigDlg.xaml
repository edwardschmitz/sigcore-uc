<Window x:Class="SigCoreTestClient.PIDConfigDlg"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        WindowStartupLocation="CenterScreen"
        Title="PID Configuration" Height="580" Width="500">
    <Grid Margin="20">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="auto"/>
            <ColumnDefinition Width="auto" />
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <!-- Title -->
            <RowDefinition Height="Auto" />
            <!-- Enabled -->
            <RowDefinition Height="Auto" />
            <!-- Kp -->
            <RowDefinition Height="Auto" />
            <!-- Ki -->
            <RowDefinition Height="Auto" />
            <!-- Kd -->
            <RowDefinition Height="Auto" />
            <!-- Output Min -->
            <RowDefinition Height="Auto" />
            <!-- Output Max -->
            <RowDefinition Height="Auto" />
            <!-- PV Min -->
            <RowDefinition Height="Auto" />
            <!-- PV Max -->
            <RowDefinition Height="Auto" />
            <!-- Integral Limit -->
            <RowDefinition Height="Auto" />
            <!-- Reset on Mode Change -->
            <RowDefinition Height="Auto" />
            <!-- Auto Mode -->
            <RowDefinition Height="Auto" />
            <!-- PV Source -->
            <RowDefinition Height="Auto" />
            <!-- Output Destination -->
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Labels and Inputs -->
        <TextBlock Grid.Row="0" Grid.Column="1" Text="Title:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="0" Grid.Column="2" Text="{Binding Title}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="1" Grid.Column="1" Text="Enabled:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <CheckBox Grid.Row="1" Grid.Column="2" IsChecked="{Binding IsEnabled}" Margin="4" VerticalAlignment="Center"/>

        <TextBlock Grid.Row="2" Grid.Column="1" Text="Kp:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="2" Grid.Column="2" Text="{Binding Kp}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="3" Grid.Column="1" Text="Ki:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="3" Grid.Column="2" Text="{Binding Ki}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="4" Grid.Column="1" Text="Kd:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="4" Grid.Column="2" Text="{Binding Kd}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="5" Grid.Column="1" Text="Output Min:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="5" Grid.Column="2" Text="{Binding OutputMin}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="6" Grid.Column="1" Text="Output Max:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="6" Grid.Column="2" Text="{Binding OutputMax}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="7" Grid.Column="1" Text="PV Min:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="7" Grid.Column="2" Text="{Binding PVMin}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="8" Grid.Column="1" Text="PV Max:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="8" Grid.Column="2" Text="{Binding PVMax}" Margin="4" Padding="5,2"/>

        <!-- NEW Anti-Windup Config -->
        <TextBlock Grid.Row="9" Grid.Column="1" Text="Integral Limit:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <TextBox Grid.Row="9" Grid.Column="2" Text="{Binding IntegralLimit}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="10" Grid.Column="1" Text="Reset on Mode Change:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <CheckBox Grid.Row="10" Grid.Column="2" IsChecked="{Binding ResetOnModeChange}" Margin="4" VerticalAlignment="Center"/>

        <!-- Existing Items Continue -->
        <TextBlock Grid.Row="11" Grid.Column="1" Text="Auto Mode:" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <CheckBox Grid.Row="11" Grid.Column="2" IsChecked="{Binding IsAutoMode}" Margin="4" VerticalAlignment="Center"/>

        <TextBlock Grid.Row="12" Grid.Column="1" Text="PV Source (AIN):" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <ComboBox Grid.Row="12" Grid.Column="2" ItemsSource="{Binding PvSources}"
                  SelectedItem="{Binding PvSource}" Margin="4" Padding="5,2"/>

        <TextBlock Grid.Row="13" Grid.Column="1" Text="Output Destination (AOUT):" VerticalAlignment="Center" Margin="4" TextAlignment="Right"/>
        <ComboBox Grid.Row="13" Grid.Column="2" ItemsSource="{Binding OutputDestinations}"
                  SelectedItem="{Binding OutputDestination}" Margin="4" Padding="5,2"/>

        <!-- Buttons on the left -->
        <StackPanel Grid.Row="0" Grid.Column="0" Grid.RowSpan="14" Orientation="Vertical" VerticalAlignment="Top">
            <Button x:Name="SaveBtn" Content="Save" Width="80" Margin="4" Click="SaveBtn_Click"/>
            <Button x:Name="CloseBtn" Content="Cancel" Width="80" Margin="4" Click="CloseBtn_Click"/>
        </StackPanel>
    </Grid>
</Window>
